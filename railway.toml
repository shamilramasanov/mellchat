[build]
builder = "NIXPACKS"

[build.env]
NODE_VERSION = "18"
CI = "false"

[deploy]
startCommand = "cd backend/api-gateway && npm install && npm run start:with-migrations"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Railway will use the backend/api-gateway directory
[build.context]
context = "backend/api-gateway"

# Skip frontend build for backend deployment
[build.ignore]
ignore = ["frontend/**", "docs/**", "*.md"]
